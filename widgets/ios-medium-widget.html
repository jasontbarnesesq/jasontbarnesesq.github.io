<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=338, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Personal Dashboard Â· iOS26 Widget</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&display=swap" rel="stylesheet">
<!--
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘  iOS 26 Medium Widget  Â·  338 Ã— 158 pt                  â•‘
  â•‘  Compatible with App Widgy (HTML Widget)                 â•‘
  â•‘                                                          â•‘
  â•‘  Features:                                               â•‘
  â•‘  1. Today's mini events list (up to 3)                   â•‘
  â•‘  2. Current day & date                                   â•‘
  â•‘  3. Current weather  (Open-Meteo, free, no key)         â•‘
  â•‘  4. Current moon phase (Jean Meeus algorithm)            â•‘
  â•‘  5. Total daily step count                               â•‘
  â•‘  6. Unlock trigger button                                â•‘
  â•‘  7. One-tap shortcut to open Claude                      â•‘
  â•‘                                                          â•‘
  â•‘  Data injection via URL parameters (Widgy / Shortcuts):  â•‘
  â•‘    ?lat=32.7&lon=-96.7   override GPS coords             â•‘
  â•‘    ?temp=72&wdesc=Sunny&wicon=â˜€ï¸&loc=Dallas              â•‘
  â•‘    ?steps=8432                                           â•‘
  â•‘    ?events=[{"title":"Standup","start":"2026-02-25T09:00"},...] â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
<style>
/* â”€â”€ Reset â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

/* â”€â”€ Design tokens (jasontbarnes.com palette) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
:root {
  --ochre:      #C17D2E;
  --ochre-dk:   #A86820;
  --rust:       #A64E2A;
  --sienna:     #7A3B1E;
  --bark:       #3D2B1A;
  --bark-deep:  #221206;
  --bark-mid:   #5C4230;
  --bark-lt:    #8B6B50;
  --sage:       #6B7A5E;
  --sage-lt:    #8A9B7C;
  --parch:      #EDE3D0;
  --parch-dk:   #D9C9AE;
  --warm-white: #FAF7F2;
  --sep:        rgba(193,125,46,0.22);
  --r:          22px;
}

/* â”€â”€ Page wrapper (web preview) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
body {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  /* warm linen â€” echoes the site's parchment palette */
  background: linear-gradient(135deg, #C4A882 0%, #B8976C 100%);
  font-family: 'DM Sans', system-ui, sans-serif;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€ Widget shell â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.widget {
  position: relative;
  width: 338px;
  height: 158px;
  /* Rich bark base with diagonal warmth */
  background:
    linear-gradient(135deg, rgba(193,125,46,0.11) 0%, transparent 52%),
    linear-gradient(315deg, rgba(122,59,30,0.14) 0%, transparent 52%),
    #221206;
  border-radius: var(--r);
  border: 1px solid rgba(193,125,46,0.22);
  overflow: hidden;
  display: grid;
  grid-template-columns: 88px 1fr;
  grid-template-rows: 1fr 36px;
  box-shadow:
    0 1px 0 rgba(212,148,63,0.14) inset,   /* top specular edge  */
    0 16px 44px rgba(34,18,6,0.70),
    0 2px  8px  rgba(34,18,6,0.45);
}

/* Warm ochre glow â€” upper left */
.widget::before {
  content: '';
  position: absolute;
  top: -55px; left: -35px;
  width: 210px; height: 190px;
  background: radial-gradient(circle, rgba(193,125,46,0.18) 0%, transparent 68%);
  pointer-events: none;
  z-index: 0;
}

/* Sienna warmth â€” lower right */
.widget::after {
  content: '';
  position: absolute;
  bottom: -45px; right: -25px;
  width: 170px; height: 150px;
  background: radial-gradient(circle, rgba(166,78,42,0.16) 0%, transparent 66%);
  pointer-events: none;
  z-index: 0;
}

/* â”€â”€ LEFT PANEL: Date â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.col-date {
  grid-column: 1;
  grid-row: 1;
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  padding: 13px 9px 10px 13px;
  border-right: 1px solid var(--sep);
}

.date-weekday {
  font-family: 'DM Sans', system-ui, sans-serif;
  font-size: 8px;
  font-weight: 600;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--ochre);
  line-height: 1;
}

/* Playfair Display gives the date number a legal-journal gravitas */
.date-day {
  font-family: 'Playfair Display', Georgia, 'Times New Roman', serif;
  font-size: 50px;
  font-weight: 700;
  letter-spacing: -1px;
  line-height: 0.95;
  color: var(--warm-white);
  margin-top: 2px;
}

.date-month {
  font-family: 'DM Sans', system-ui, sans-serif;
  font-size: 9px;
  font-weight: 400;
  color: var(--parch-dk);
  text-transform: uppercase;
  letter-spacing: 0.09em;
  margin-top: 4px;
}

.date-clock {
  font-family: 'DM Sans', system-ui, sans-serif;
  font-size: 12px;
  font-weight: 300;
  color: var(--bark-lt);
  letter-spacing: 0.02em;
  margin-top: 5px;
}

/* â”€â”€ RIGHT PANEL: Info + Events â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.col-main {
  grid-column: 2;
  grid-row: 1;
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  padding: 10px 12px 8px 10px;
  gap: 6px;
  overflow: hidden;
}

/* Weather + Moon row */
.row-info {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-shrink: 0;
}

.weather {
  display: flex;
  align-items: center;
  gap: 5px;
}

.weather-icon { font-size: 16px; line-height: 1; }

.weather-temp {
  font-size: 14px;
  font-weight: 500;
  color: var(--warm-white);
  letter-spacing: -0.2px;
  line-height: 1;
}

.weather-sub {
  font-size: 8.5px;
  color: var(--parch-dk);
  line-height: 1;
  margin-top: 1px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 110px;
}

.moon {
  display: flex;
  align-items: center;
  gap: 3px;
  flex-shrink: 0;
}

.moon-icon { font-size: 14px; line-height: 1; }

.moon-label {
  font-size: 8.5px;
  color: var(--parch-dk);
  white-space: nowrap;
}

/* Events */
.events-section {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 0;
  min-height: 0;
  overflow: hidden;
}

.events-label {
  font-family: 'DM Sans', system-ui, sans-serif;
  font-size: 7.5px;
  font-weight: 600;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--ochre);
  margin-bottom: 3px;
}

.event-row {
  display: flex;
  align-items: center;
  gap: 5px;
  height: 17px;
  overflow: hidden;
}

.event-pip {
  width: 4px;
  height: 4px;
  border-radius: 50%;
  flex-shrink: 0;
  background: var(--ochre);
}
.event-pip.p1 { background: var(--ochre); }
.event-pip.p2 { background: var(--rust);  }
.event-pip.p3 { background: var(--sage);  }

.event-time {
  font-size: 9px;
  font-weight: 400;
  color: var(--bark-lt);
  min-width: 40px;
  flex-shrink: 0;
}

.event-title {
  font-size: 10px;
  font-weight: 400;
  color: var(--warm-white);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.events-empty {
  font-size: 10px;
  color: var(--bark-lt);
  font-style: italic;
  line-height: 17px;
}

/* â”€â”€ BOTTOM BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.bar-bottom {
  grid-column: 1 / 3;
  grid-row: 2;
  position: relative;
  z-index: 1;
  border-top: 1px solid var(--sep);
  display: flex;
  align-items: center;
  padding: 0 10px 0 13px;
  gap: 6px;
}

/* Steps */
.steps-group {
  display: flex;
  align-items: baseline;
  gap: 3px;
  flex: 1;
}

.steps-icon { font-size: 12px; }

.steps-val {
  font-size: 13px;
  font-weight: 600;
  color: var(--sage-lt);
  letter-spacing: -0.3px;
  font-variant-numeric: tabular-nums;
}

.steps-unit {
  font-size: 8.5px;
  color: var(--bark-lt);
}

/* Shared button styles */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 5px 9px;
  border-radius: 8px;
  border: 1px solid transparent;
  text-decoration: none;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  transition: opacity 0.12s, transform 0.08s;
  user-select: none;
  -webkit-user-select: none;
}

.btn:active {
  opacity: 0.65;
  transform: scale(0.95);
}

.btn-icon { font-size: 11px; line-height: 1; }

.btn-label {
  font-family: 'DM Sans', system-ui, sans-serif;
  font-size: 10px;
  font-weight: 500;
  color: var(--warm-white);
  white-space: nowrap;
}

/* Rust-toned unlock button */
.btn-unlock {
  background: rgba(166,78,42,0.22);
  border-color: rgba(166,78,42,0.40);
}

/* Ochre-toned Claude button */
.btn-claude {
  background: rgba(193,125,46,0.20);
  border-color: rgba(193,125,46,0.38);
}

/* Subtle pulse on step count */
@keyframes step-pulse {
  0%,100% { opacity: 1; }
  50%      { opacity: 0.68; }
}
.steps-val.pulse { animation: step-pulse 2.8s ease-in-out infinite; }

</style>
</head>
<body>

<div class="widget" role="region" aria-label="Personal Dashboard Widget">

  <!-- â”€â”€ LEFT: Date â”€â”€ -->
  <div class="col-date">
    <div class="date-weekday" id="el-weekday">WED</div>
    <div class="date-day"     id="el-day">25</div>
    <div class="date-month"   id="el-month">Feb Â· 2026</div>
    <div class="date-clock"   id="el-clock">9:41 AM</div>
  </div>

  <!-- â”€â”€ RIGHT: Weather / Moon / Events â”€â”€ -->
  <div class="col-main">

    <!-- Weather + Moon -->
    <div class="row-info">
      <div class="weather">
        <span class="weather-icon" id="el-w-icon">â›…</span>
        <div>
          <div class="weather-temp" id="el-w-temp">72Â°F</div>
          <div class="weather-sub"  id="el-w-sub">Partly Cloudy Â· Dallas</div>
        </div>
      </div>
      <div class="moon">
        <span class="moon-icon"  id="el-moon-icon">ðŸŒ“</span>
        <span class="moon-label" id="el-moon-label">First Quarter</span>
      </div>
    </div>

    <!-- Events -->
    <div class="events-section">
      <div class="events-label">Today</div>
      <div id="el-events"><!-- populated by JS --></div>
    </div>

  </div><!-- /col-main -->

  <!-- â”€â”€ BOTTOM BAR: Steps Â· Unlock Â· Claude â”€â”€ -->
  <div class="bar-bottom">

    <div class="steps-group">
      <span class="steps-icon">ðŸ¦¶</span>
      <span class="steps-val pulse" id="el-steps">â€”</span>
      <span class="steps-unit">steps today</span>
    </div>

    <!-- Unlock trigger -->
    <a id="btn-unlock" class="btn btn-unlock" href="#" onclick="handleUnlock(event)">
      <span class="btn-icon">ðŸ”“</span>
      <span class="btn-label">Unlock</span>
    </a>

    <!-- Open Claude -->
    <a id="btn-claude" class="btn btn-claude" href="claude://" onclick="handleClaude(event)">
      <span class="btn-icon">âœ¦</span>
      <span class="btn-label">Claude</span>
    </a>

  </div><!-- /bar-bottom -->

</div><!-- /widget -->

<script>
'use strict';

/* ================================================================
   HELPERS
================================================================ */
const $ = id => document.getElementById(id);

const DAYS   = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
const MONTHS = ['Jan','Feb','Mar','Apr','May','Jun',
                'Jul','Aug','Sep','Oct','Nov','Dec'];

function fmt12h(h, m) {
  const ap = h < 12 ? 'AM' : 'PM';
  const hh = h % 12 || 12;
  return hh + ':' + String(m).padStart(2,'0') + ' ' + ap;
}

function esc(s) {
  return String(s).replace(/[&<>"']/g,
    c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
}

const params = new URLSearchParams(location.search);

/* ================================================================
   1 + 2 Â· DATE & TIME
================================================================ */
function refreshDateTime() {
  const now = new Date();
  $('el-weekday').textContent = DAYS[now.getDay()].toUpperCase();
  $('el-day').textContent     = now.getDate();
  $('el-month').textContent   = MONTHS[now.getMonth()] + ' Â· ' + now.getFullYear();
  $('el-clock').textContent   = fmt12h(now.getHours(), now.getMinutes());
}

/* ================================================================
   4 Â· MOON PHASE  (Jean Meeus, "Astronomical Algorithms")
================================================================ */
const PHASES = [
  { cap:0.025, e:'ðŸŒ‘', l:'New Moon'       },
  { cap:0.225, e:'ðŸŒ’', l:'Wax. Crescent'  },
  { cap:0.275, e:'ðŸŒ“', l:'First Quarter'  },
  { cap:0.475, e:'ðŸŒ”', l:'Wax. Gibbous'   },
  { cap:0.525, e:'ðŸŒ•', l:'Full Moon'       },
  { cap:0.725, e:'ðŸŒ–', l:'Wan. Gibbous'   },
  { cap:0.775, e:'ðŸŒ—', l:'Last Quarter'   },
  { cap:0.975, e:'ðŸŒ˜', l:'Wan. Crescent'  },
  { cap:1.001, e:'ðŸŒ‘', l:'New Moon'       },
];

function calcMoonPhase(date) {
  let Y = date.getFullYear(), M = date.getMonth() + 1, D = date.getDate();
  if (M <= 2) { Y--; M += 12; }
  const A  = Math.floor(Y / 100);
  const B  = 2 - A + Math.floor(A / 4);
  const JD = Math.floor(365.25 * (Y + 4716))
           + Math.floor(30.6001 * (M + 1))
           + D + B - 1524.5;
  // Days since known new moon: Jan 6.5 2000 UTC (JD 2451549.5)
  const phase = (((JD - 2451549.5) / 29.53058867) % 1 + 1) % 1;
  return PHASES.find(p => phase < p.cap) || PHASES[0];
}

function refreshMoon() {
  const p = calcMoonPhase(new Date());
  $('el-moon-icon').textContent  = p.e;
  $('el-moon-label').textContent = p.l;
}

/* ================================================================
   3 Â· WEATHER  â€” Open-Meteo API (free, no key required)
   Override:  ?temp=72&wdesc=Sunny&wicon=â˜€ï¸&loc=Dallas
   GPS:       ?lat=32.77&lon=-96.79
================================================================ */
const WMO = {
   0:['â˜€ï¸','Clear'],       1:['ðŸŒ¤','Mostly Clear'],  2:['â›…','Partly Cloudy'],
   3:['â˜ï¸','Overcast'],   45:['ðŸŒ«','Foggy'],         48:['ðŸŒ«','Icy Fog'],
  51:['ðŸŒ¦','Drizzle'],    53:['ðŸŒ¦','Drizzle'],       55:['ðŸŒ§','Heavy Drizzle'],
  61:['ðŸŒ§','Light Rain'], 63:['ðŸŒ§','Rain'],           65:['ðŸŒ§','Heavy Rain'],
  71:['ðŸŒ¨','Light Snow'], 73:['â„ï¸','Snow'],           75:['â„ï¸','Heavy Snow'],
  77:['ðŸŒ¨','Snow Grains'],80:['ðŸŒ¦','Showers'],        81:['ðŸŒ§','Heavy Showers'],
  82:['â›ˆ','Violent Showers'],95:['â›ˆ','Thunderstorm'],96:['â›ˆ','Hail'],99:['â›ˆ','Hail'],
};

function wmoInfo(code) {
  if (WMO[code]) return WMO[code];
  const k = Object.keys(WMO).map(Number).sort((a,b) => b-a).find(k => k <= code);
  return WMO[k] || ['ðŸŒ¡','Unknown'];
}

function fetchWeather() {
  // Manual URL-param override (useful when called from Widgy / Shortcuts)
  if (params.get('temp')) {
    $('el-w-temp').textContent = params.get('temp') + 'Â°F';
    const desc = params.get('wdesc') || '';
    const loc  = params.get('loc')   || '';
    $('el-w-sub').textContent  = [desc, loc].filter(Boolean).join(' Â· ');
    if (params.get('wicon')) $('el-w-icon').textContent = params.get('wicon');
    return;
  }
  // Default coords: Dallas, TX  â€”  swap via ?lat=â€¦&lon=â€¦
  const lat = params.get('lat') || '32.7767';
  const lon = params.get('lon') || '-96.7970';
  const url = `https://api.open-meteo.com/v1/forecast`
            + `?latitude=${lat}&longitude=${lon}`
            + `&current=temperature_2m,weather_code`
            + `&temperature_unit=fahrenheit&timezone=auto`;

  fetch(url)
    .then(r => r.json())
    .then(d => {
      const temp = Math.round(d.current.temperature_2m);
      const [emoji, desc] = wmoInfo(d.current.weather_code);
      $('el-w-icon').textContent = emoji;
      $('el-w-temp').textContent = temp + 'Â°F';
      $('el-w-sub').textContent  = desc;
    })
    .catch(() => { /* keep placeholder values */ });
}

/* ================================================================
   5 Â· STEP COUNT
   Inject via URL: ?steps=8432
   Widgy bridge:   uncomment WidgyBridge block below
================================================================ */
function loadSteps() {
  const raw = params.get('steps');
  if (raw) {
    setSteps(parseInt(raw, 10));
    return;
  }

  /* â”€â”€ Widgy health bridge â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (typeof WidgyBridge !== 'undefined' && WidgyBridge.health) {
    WidgyBridge.health.getStepCount(function(n) { setSteps(n); });
    return;
  }
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

  // Demo fallback
  setSteps(8432);
}

function setSteps(n) {
  $('el-steps').textContent = Number(n).toLocaleString();
}

/* ================================================================
   1 Â· CALENDAR EVENTS  (today)
   Inject via URL: ?events=[{"title":"Standup","start":"2026-02-25T09:00"},...]
   Widgy bridge:   uncomment WidgyBridge block below
================================================================ */
const PIP_CLASS = ['p1','p2','p3'];

function renderEvents(list) {
  const el = $('el-events');
  if (!list || list.length === 0) {
    el.innerHTML = '<div class="events-empty">No events today</div>';
    return;
  }
  el.innerHTML = list.slice(0, 3).map((ev, i) => {
    const ts = ev.start || ev.time || '';
    const d  = ts ? new Date(ts) : null;
    const t  = (d && !isNaN(d))
               ? fmt12h(d.getHours(), d.getMinutes())
               : (String(ts) || 'All Day');
    return `<div class="event-row">
      <span class="event-pip ${PIP_CLASS[i]}"></span>
      <span class="event-time">${esc(t)}</span>
      <span class="event-title">${esc(ev.title || 'Untitled')}</span>
    </div>`;
  }).join('');
}

function loadEvents() {
  const raw = params.get('events');
  if (raw) {
    try { renderEvents(JSON.parse(decodeURIComponent(raw))); return; }
    catch(e) { /* fall through */ }
  }

  /* â”€â”€ Widgy calendar bridge â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (typeof WidgyBridge !== 'undefined' && WidgyBridge.calendar) {
    WidgyBridge.calendar.getTodayEvents(function(events) {
      renderEvents(events);
    });
    return;
  }
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

  // Demo events (replace or remove in production)
  const today = new Date();
  const d = (h, m) => new Date(today.getFullYear(), today.getMonth(),
                                today.getDate(), h, m).toISOString();
  renderEvents([
    { title: 'Team Standup',       start: d( 9,  0) },
    { title: 'Client Call Â· Smith',start: d(14,  0) },
    { title: 'Filing Deadline',    start: d(16, 30) },
  ]);
}

/* ================================================================
   6 Â· UNLOCK TRIGGER
   Attempts (in order):
     1. Widgy native lock command
     2. Apple Shortcuts shortcut named "Lock Screen"
     3. iOS Settings â†’ Passcode deep-link
   All three require the matching app/shortcut to be installed.
================================================================ */
function handleUnlock(e) {
  e.preventDefault();

  // Visual tap feedback
  const btn = $('btn-unlock');
  btn.style.background = 'rgba(166,78,42,0.52)';
  setTimeout(() => (btn.style.background = ''), 250);

  /* â”€â”€ Widgy native â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (typeof WidgyBridge !== 'undefined' && WidgyBridge.lock) {
    WidgyBridge.lock();
    return;
  }
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

  // Try Shortcuts â†’ Apple Shortcuts app must have a shortcut named "Lock Screen"
  // Create it: Shortcuts app â–¸ New Shortcut â–¸ Add Action â–¸ "Lock Screen"
  const attempts = [
    'shortcuts://run-shortcut?name=Lock%20Screen',
    'widgy://lock',
  ];
  attempts.forEach((url, i) =>
    setTimeout(() => { window.location.href = url; }, i * 350)
  );
}

/* ================================================================
   7 Â· CLAUDE SHORTCUT
   Opens the Claude iOS app; falls back to claude.ai in browser.
================================================================ */
function handleClaude(e) {
  e.preventDefault();

  // Try the Claude URL scheme (requires Claude app installed)
  window.location.href = 'claude://';

  // Fallback: if scheme unhandled, open web after a short delay
  setTimeout(() => {
    try { window.open('https://claude.ai', '_blank'); }
    catch(_) { window.location.href = 'https://claude.ai'; }
  }, 900);
}

/* ================================================================
   INIT
================================================================ */
function init() {
  refreshDateTime();
  refreshMoon();
  fetchWeather();
  loadSteps();
  loadEvents();

  // Refresh clock every 30 s
  setInterval(refreshDateTime, 30000);
}

document.addEventListener('DOMContentLoaded', init);
</script>

</body>
</html>
